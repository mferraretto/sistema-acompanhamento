<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sistema de Acompanhamento de An√∫ncios</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, query, where, updateDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAJHISEca3wibw92Bw6UQCpQuyhtkjAoWE",
      authDomain: "acompanhamento-anuncios.firebaseapp.com",
      projectId: "acompanhamento-anuncios",
      storageBucket: "acompanhamento-anuncios.appspot.com",
      messagingSenderId: "993424162956",
      appId: "1:993424162956:web:37bb9a39d8aee076cdfba9"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    window.firestore = db;
    window.firebaseCollection = collection;
    window.firebaseAddDoc = addDoc;
    window.firebaseGetDocs = getDocs;
    window.firebaseQuery = query;
    window.firebaseWhere = where;
    window.firebaseUpdateDoc = updateDoc;
    window.firebaseDoc = doc;
  </script>
</head>
<body class="bg-light">
<div class="container py-4">
  <h1 class="mb-4 text-center">üìä Sistema de Acompanhamento de An√∫ncios</h1>
  <ul class="nav nav-tabs" id="tabs">
    <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#cadastro">Cadastro de An√∫ncio</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#alteracoes">Altera√ß√µes</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#historico">Hist√≥rico</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#evolucao">Evolu√ß√£o</a></li>
        <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#listaAnuncios">Lista de An√∫ncios</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#relatorio">Relat√≥rio</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#dashboard">Comparativo</a></li>
  </ul>
  <div class="tab-content pt-3">
    <!-- Aba Cadastro de An√∫ncio -->
<div class="tab-pane fade show active" id="cadastro">
  <div class="mb-3">
     <!-- üìÅ Importa√ß√£o de Pedidos -->
  <div class="mb-3">
    <label class="form-label">üì• Importar Planilha de Pedidos (.xlsx)</label>
    <input type="file" class="form-control" id="inputPlanilhaPedidos" accept=".xlsx" multiple />
    <div id="previewPedidos" class="mt-3 table-responsive"></div>
    <button class="btn btn-secondary mt-2" id="savePedidosBtn">Salvar Pedidos</button>
  </div>
    <!-- üìÅ Importa√ß√£o de Planilhas Shopee -->
  <div class="mb-3">
    <label class="form-label">üì• Importar Planilha Shopee (.xlsx)</label>
    <input type="file" class="form-control" id="inputShopeePlanilhas" accept=".xlsx" multiple />
    <div id="previewShopeePlanilhas" class="mt-3 table-responsive"></div>
    <button class="btn btn-secondary mt-2" id="btnSalvarShopeePlanilhas">Salvar Planilhas</button>
  </div>
  <form id="formCadastro" class="row g-3">
        <div class="col-md-6">
          <label class="form-label">Nome do An√∫ncio</label>
          <input type="text" class="form-control" id="nomeAnuncio" required />
        </div>
        <div class="col-md-6">
          <label class="form-label">Link Shopee</label>
          <input type="url" class="form-control" id="linkShopee" required />
        </div>
        <div class="col-md-6">
          <label class="form-label">SKU</label>
          <input type="text" class="form-control" id="sku" required />
        </div>
        <div class="col-md-6">
          <label class="form-label">Imagem (URL)</label>
          <input type="url" class="form-control" id="imagem" />
        </div>
        <div class="col-md-6">
          <label class="form-label">Data do Cadastro</label>
          <input type="date" class="form-control" id="dataCadastro" required />
        </div>
        <div class="col-12">
          <button type="submit" class="btn btn-primary">Salvar An√∫ncio</button>
        </div>
      </form>
    </div>

    <!-- Aba Altera√ß√µes -->
    <div class="tab-pane fade" id="alteracoes">
      <form id="formAlteracao" class="row g-3">
        <div class="col-md-4">
          <label class="form-label">Data da Altera√ß√£o</label>
          <input type="date" class="form-control" id="dataAlteracao" required />
        </div>
        <div class="col-md-4">
          <label class="form-label">Campo Alterado</label>
          <input type="text" class="form-control" id="campoAlterado" required />
        </div>
        <div class="col-md-6">
          <label class="form-label">Antes</label>
          <input type="text" class="form-control" id="valorAntes" />
        </div>
        <div class="col-md-6">
          <label class="form-label">Depois</label>
          <input type="text" class="form-control" id="valorDepois" />
        </div>
        <div class="col-md-12">
          <label class="form-label">Motivo da Mudan√ßa</label>
          <textarea class="form-control" id="motivoMudanca"></textarea>
        </div>
        <div class="col-12">
          <button type="submit" class="btn btn-warning">Registrar Altera√ß√£o</button>
        </div>
      </form>
    </div>

    <!-- Aba Hist√≥rico -->
    <div class="tab-pane fade" id="historico">
      <h5>Hist√≥rico de Altera√ß√µes</h5>
      <div id="listaHistorico"></div>
    </div>
<!-- Aba Evolu√ß√£o -->
<div class="tab-pane fade" id="evolucao">
  <h5 class="mb-3">Evolu√ß√£o do An√∫ncio</h5>
<hr />
  <form id="formEvolucao" class="row g-3">
    <div class="col-md-4">
      <label class="form-label">Nome do An√∫ncio</label>
      <input type="text" class="form-control" id="nomeEvolucao" required />
    </div>
    <div class="col-md-4">
      <label class="form-label">Data</label>
      <input type="date" class="form-control" id="dataEvolucao" required />
    </div>
    <div class="col-md-4">
      <label class="form-label">Mudan√ßas Aplicadas</label>
      <input type="text" class="form-control" id="mudancas" />
    </div>
    <div class="col-md-3">
      <label class="form-label">Visitantes</label>
      <input type="number" class="form-control" id="visitantes" />
    </div>
    <div class="col-md-3">
      <label class="form-label">Visualiza√ß√µes</label>
      <input type="number" class="form-control" id="visualizacoes" />
    </div>
    <div class="col-md-3">
      <label class="form-label">Cliques</label>
      <input type="number" class="form-control" id="cliques" />
    </div>
    <div class="col-md-3">
      <label class="form-label">Carrinhos</label>
      <input type="number" class="form-control" id="carrinhos" />
    </div>
    <div class="col-md-3">
      <label class="form-label">Convers√£o Carrinho (%)</label>
      <input type="number" step="0.1" class="form-control" id="conversaoCarrinho" />
    </div>
    <div class="col-md-3">
      <label class="form-label">Pedidos</label>
      <input type="number" class="form-control" id="pedidos" />
    </div>
    <div class="col-md-3">
      <label class="form-label">Convers√£o Compra (%)</label>
      <input type="number" step="0.1" class="form-control" id="conversaoCompra" />
    </div>
    <div class="col-md-3">
      <label class="form-label">Vendas (R$)</label>
      <input type="number" step="0.01" class="form-control" id="vendas" />
    </div>
    <div class="col-12">
      <button type="submit" class="btn btn-success">Salvar Evolu√ß√£o</button>
    </div>
  </form>
  <div class="mt-4">
    <canvas id="graficoEvolucao" height="100"></canvas>
  </div>
</div>
    <!-- Aba Lista de An√∫ncios -->
<div class="tab-pane fade" id="listaAnuncios">
  <div class="table-responsive">
    <table class="table table-bordered table-sm">
      <thead>
        <tr>
          <th>SKU</th>
          <th>Nome</th>
          <th>Pre√ßo</th>
          <th>Status</th>
          <th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody id="tabelaAnunciosBody"></tbody>
    </table>
  </div>
</div>
<!-- Aba Relat√≥rio -->
<div class="tab-pane fade" id="relatorio">
  <h5 class="mb-3">Exporta√ß√£o de Dados</h5>
  <button class="btn btn-outline-primary" onclick="exportarCSV()">üìÅ Exportar CSV</button>
  <button class="btn btn-outline-danger" onclick="exportarPDF()">üìÑ Exportar PDF</button>
</div>

<!-- Aba Dashboard Comparativo -->
<div class="tab-pane fade" id="dashboard">
  <h5 class="mb-3">Dashboard Comparativo entre An√∫ncios</h5>
  <canvas id="graficoComparativo" height="120"></canvas>
</div>

</div> <!-- fechamento tab-content -->
  <div class="modal fade" id="modalEditarAnuncio" tabindex="-1">
  <div class="modal-dialog">
    <form id="formEditAnuncio" class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Editar An√∫ncio</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="editDocId">
        <div class="mb-3">
          <label class="form-label">Nome</label>
          <input type="text" class="form-control" id="editNome" />
        </div>
        <div class="mb-3">
          <label class="form-label">Pre√ßo</label>
          <input type="number" step="0.01" class="form-control" id="editPreco" />
        </div>
        <div class="mb-3">
          <label class="form-label">Status</label>
          <input type="text" class="form-control" id="editStatus" />
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="submit" class="btn btn-primary">Salvar</button>
      </div>
    </form>
  </div>
</div>
</div> <!-- fechamento container -->

<!-- Scripts principais -->
<script>
  // Exemplo de uso com Chart.js ‚Äì gr√°fico da evolu√ß√£o
  const ctxEvolucao = document.getElementById('graficoEvolucao');
  const graficoEvolucao = new Chart(ctxEvolucao, {
    type: 'line',
    data: {
      labels: ['07/01', '07/02', '07/03'],
      datasets: [
        {
          label: 'Vendas (R$)',
          data: [250, 400, 180],
          borderWidth: 2,
          tension: 0.3
        }
      ]
    },
    options: {
      responsive: true,
      scales: {
        y: { beginAtZero: true }
      }
    }
  });

  // Comparativo (exemplo)
  const ctxComparativo = document.getElementById('graficoComparativo');
  const graficoComparativo = new Chart(ctxComparativo, {
    type: 'bar',
    data: {
      labels: ['An√∫ncio A', 'An√∫ncio B'],
      datasets: [
        {
          label: 'Vendas (R$)',
          data: [850, 920],
          backgroundColor: ['#0d6efd', '#198754']
        }
      ]
    },
    options: {
      responsive: true,
      scales: {
        y: { beginAtZero: true }
      }
    }
  });

  function exportarCSV() {
    alert("Exporta√ß√£o CSV ainda n√£o implementada.");
  }

  function exportarPDF() {
    alert("Exporta√ß√£o PDF ainda n√£o implementada.");
  }
</script>

<!-- Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- Importa√ß√£o de planilhas com SheetJS -->
 
<script type="module" src="importShopee.js"></script>
<script type="module" src="importPedidos.js"></script>

<script type="module" src="app.js"></script>
  <script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('service-worker.js');
  }
</script>

</body>
</html>
